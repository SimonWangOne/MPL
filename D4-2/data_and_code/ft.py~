import matplotlib.pyplot as plt
import numpy as np
import seaborn

t=[]
y=[]
t_factor = 50E-3
j = 18
filename = str(j)+'_1.csv'
with open(filename) as file_object:
    lines = file_object.readlines()
    lines.remove(lines[0])
    lines.remove(lines[0])
    for line in lines:
        temp = line.split(',')
        t.append(float(temp[0]))
        y.append(float(temp[1]))
        
    factor = 2.0E4
    n = len(y) # length of the signal
    k = np.arange(n)
    frq = k*factor #
    YY = np.fft.fft(y) # 未归一化
    i=0
    for i in range(600,800):
        if YY[i]-YY[i-1] >= 0.2:
            print(str(frq[i]/1.0E6)+" MHz")
        #Y = np.fft.fft(y)/n # fft computing and normalization 归一化
        #Y1 = Y[range(int(n/2))]
    plt.figure(dpi=100)
    fig, ax = plt.subplots(2, 1)


    ax[0].plot(t,y)
    ax[0].set_xlabel('Time')
    ax[0].set_ylabel('Amplitude')

    ax[1].plot(frq,abs(YY),'r') # plotting the spectrum
    ax[1].set_xlabel('Freq (Hz)')
    ax[1].set_ylabel('|Y(freq)|')
    ax[1].set_xlim(600*factor,800*factor)
    ax[1].set_ylim(0,1)
    plt.savefig("plot/"+str(j)+"_1.png")
